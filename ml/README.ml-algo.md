# LLM Hierarchical

LLM Hierarchical - это система для предсказания категорий видео на основе их описаний и заголовков. Система использует иерархическую структуру категорий и модель языка для предсказания категорий.

## Архитектура

Система состоит из следующих компонентов:

* **Модель изображений**: используется для анализа и обработки визуальной информации из видео. Она может быть обучена на большом наборе изображений и позволяет системе извлекать признаки и характеристики из видео, такие как объекты, сцены, действия и т.д.
* **Модель аудио**: используется для анализа и обработки аудиоинформации из видео. Она может быть обучена на большом наборе аудиофайлов и позволяет системе извлекать признаки и характеристики из аудио, такие как речь, музыка, звуки и т.д.
* **Модель языка**: используется для предсказания категорий на основе описаний и заголовков видео.
* **Иерархическая структура категорий**: используется для организации категорий в иерархическую структуру.
* **Фью-шот индекс**: используется для хранения примеров категорий и их описаний.

## Алгоритм работы

1. **Загрузка данных и извлечение фичей**: система загружает данные о видео.
2. **Создание иерархической структуры категорий**: система создает иерархическую структуру категорий на основе данных о категориях.
3. **Использование фью-шот индекса**: система использует фью-шот индекс для хранения примеров категорий и их описаний. Это позволяет системе быстро и эффективно находить подобные категории и их описания.
4. **Использование иерархической структуры категорий**: система использует иерархическую структуру категорий для организации категорий и их подкатегорий. Это позволяет системе предсказывать категории на разных уровнях детализации.
5. **Предсказание категорий**: система использует модель языка для предсказания категорий на основе описаний и заголовков видео. Модель языка анализирует текст и извлекает признаки и характеристики, которые используются для предсказания категорий.
6. **Оценка результатов**: система оценивает результаты предсказания категорий и корректирует модель языка и иерархическую структуру категорий для улучшения точности предсказания.


## Преимущества

* **Высокая точность**: система обеспечивает высокую точность предсказания категорий благодаря использованию иерархической структуры категорий и модели языка.
* **Гибкость**: система может быть легко адаптирована для различных задач и данных.
* **Эффективность**: система обеспечивает эффективное использование ресурсов благодаря использованию фью-шот индекса.

## Использование

Система может быть использована для различных задач, включая:

* **Классификация видео**: система может быть использована для классификации видео на основе их описаний и заголовков.
* **Рекомендация видео**: система может быть использована для рекомендации видео пользователям на основе их интересов и предпочтений.
* **Анализ видео**: система может быть использована для анализа видео и выявления закономерностей и тенденций.

## Метрики

Для оценки качества работы системы мы использовали метрику IoU (Intersection over Union), которая измеряет степень пересечения предсказанных и реальных категорий. Однако, мы обнаружили, что эта метрика не очень удачна для данной задачи, поскольку она не учитывает важные факторы, такие как количество и качество предсказанных категорий.

Поэтому, мы дополнительно смотрели на такие важные штуки как:

* **Recall**: доля реальных категорий, которые были предсказаны системой.
* **Precision**: доля предсказанных категорий, которые совпадают с реальными категориями.
* **Средняя длина тегов**: среднее количество категорий, предсказанных системой для каждого видео.

Мы также обнаружили, что подбор нормирования таргета, подбор фьюшотов через фильтрацию и использование RAG (Retrieve-Augment-Generate) сильно помогли поднять метрику.

Мы замеряли метрику на 15% от тренировочного датасета, чтобы оценить качество работы системы на незнакомых данных.
